#!/bin/sh
# Synchronize source to DEPLOY_VOLUME
EXCLUDE_SRC=".deploy-excluded"
if [ -d "/src" ] && [ -n "${DEPLOY_VOLUME}" ]
then
  if [ -f "/src/${EXCLUDE_SRC}" ]
  then
    rsync -aq --delete --exclude "/${EXCLUDE_SRC}" --exclude-from "/src/${EXCLUDE_SRC}" /src/ ${DEPLOY_VOLUME}/
  else
    rsync -aq --delete /src/ ${DEPLOY_VOLUME}/
  fi
fi
sleep infinity
